!function(t){var e={};function r(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=e,r.d=function(t,e,s){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(s,n,function(e){return t[e]}.bind(null,n));return s},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=1)}([function(t,e,r){},function(t,e,r){"use strict";r.r(e);r(0);var s={getProducts:(t,e)=>(t.products.push(e),t),addProductToCart:(t,e)=>(t.cartItems.push(e),t),removeProductFromCart:(t,e)=>(t.cartItems.splice(e.index,1),t),addToCartTotal:(t,e)=>(t.cartTotal+=e,t),removeFromCartTotal:(t,e)=>(t.cartTotal-=parseFloat(t.cartItems[e.index].variants[0].price),t),sortTitle:(t,e)=>(t.filters.title=e,t),sortPrice:(t,e)=>(t.filters.price=e,t)};class n{constructor(){this.events={}}subscribe(t,e){let r=this;return r.events.hasOwnProperty(t)||(r.events[t]=[]),r.events[t].push(e)}publish(t,e={}){return this.events.hasOwnProperty(t)?this.events[t].map(t=>t(e)):[]}}class o{constructor(t){let e=this;e.actions={},e.mutations={},e.state={},e.status="resting",e.events=new n,t.hasOwnProperty("actions")&&(e.actions=t.actions),t.hasOwnProperty("mutations")&&(e.mutations=t.mutations),e.state=new Proxy(t.state||{},{set:function(t,r,s){return t[r]=s,console.log(`stateChange: ${r}: ${s}`),e.events.publish("stateChange",e.state),"mutation"!==e.status&&console.warn(`You should use a mutation to set ${r}`),e.status="resting",!0}})}dispatch(t,e){return"function"!=typeof this.actions[t]?(console.error(`Action "${t} doesn't exist.`),!1):(console.groupCollapsed(`ACTION: ${t}`),this.status="action",this.actions[t](this,e),console.groupEnd(),!0)}commit(t,e){if("function"!=typeof this.mutations[t])return console.log(`Mutation "${t}" doesn't exist`),!1;this.status="mutation";let r=this.mutations[t](this.state,e);return this.state=Object.assign(this.state,r),!0}}var i=new o({actions:{getProducts(t,e){t.commit("getProducts",e)},addProductToCart(t,e){t.commit("addProductToCart",e)},removeProductFromCart(t,e){t.commit("removeProductFromCart",e)},addToCartTotal(t,e){t.commit("addToCartTotal",e)},removeFromCartTotal(t,e){t.commit("removeFromCartTotal",e)},sortTitle(t,e){t.commit("sortTitle",e)},sortPrice(t,e){t.commit("sortPrice",e)}},mutations:s,state:{cartItems:[],products:[],cartTotal:0,filters:{title:"default-title-sort",price:"default-price-sort"}}});!function(t,e){var r=new XMLHttpRequest;r.open("GET",t,!0),r.responseType="json",r.onload=function(){var t=r.status;e(200===t?null:t,r.response)},r.send()}("https://j-parre.myshopify.com/products.json",function(t,e){null!==t?alert("Something went wrong: "+t):i.dispatch("getProducts",e)});class a{constructor(t={}){let e=this;this.render=this.render||function(){},t.store instanceof o&&t.store.events.subscribe("stateChange",()=>e.render()),t.hasOwnProperty("element")&&(this.element=t.element)}}const c=new class extends a{constructor(){super({store:i,element:document.querySelectorAll(".cart-count")})}render(){this.element.forEach(function(t){t.innerHTML=`${i.state.cartItems.length}`})}},l=new class extends a{constructor(){super({store:i,element:document.querySelector(".cart-items")})}render(){0!==i.state.cartItems.length?(this.element.innerHTML=`\n      ${i.state.cartItems.map(t=>`\n          <li>\n          <button class="remove-product">×</button></div>\n          <div class="cart-product-info">\n            <span class="title">${t.title}</span>\n            <span class="price" data-price="${t.variants[0].title}">£${t.variants[0].price}</span>\n          </div>\n          <div class="cart-product-footer">\n            <span class="size">${t.variants[0].title}</span>\n          </li>`).join("")}`,this.element.querySelectorAll("button").forEach((t,e)=>{t.addEventListener("click",()=>{i.dispatch("removeFromCartTotal",{index:e}),i.dispatch("removeProductFromCart",{index:e})})})):this.element.innerHTML='<p class="empty-cart">You have nothing in your cart &#128546;</p>'}},u=new class extends a{constructor(){super({store:i,element:document.querySelectorAll(".cart-total")})}render(){let t=this.element,e=document.querySelector(".price-tax");t.forEach(function(t){t.innerHTML=`£${parseFloat(i.state.cartTotal).toFixed(2)}`}),e.innerHTML=`£${parseFloat(i.state.cartTotal/100*20).toFixed(2)}`}},d=new class extends a{constructor(){super({store:i,element:document.querySelector(".product-list")}),this.handleAddToCart.bind(this)(),this.filterProductsArray.bind(this),this.createProductListString.bind(this)}handleAddToCart(){document.querySelector("body").addEventListener("click",function(t){if(t.target.classList.contains("add-to-cart")){t.target;let e=t.target.getAttribute("data-product-id");i.state.products[0].products.map(t=>{t.id==e&&(i.dispatch("addProductToCart",t),i.dispatch("addToCartTotal",parseFloat(t.variants[0].price)))})}})}filterProductsArray(t){let e=i.state.filters.title,r=i.state.filters.price;if("a-z"==e?t.sort(function(t,e){return t.title.toLowerCase()<e.title.toLowerCase()?-1:t.title.toLowerCase()>e.title.toLowerCase()?1:0}):"z-a"==e&&t.sort(function(t,e){return t.title.toLowerCase()>e.title.toLowerCase()?-1:t.title.toLowerCase()<e.title.toLowerCase()?1:0}),"low-high"==r)t.sort(function(t,e){return t.variants[0].price<e.variants[0].price?-1:t.variants[0].price>e.variants[0].price?1:0});else{if("high-low"!=r)return;t.sort(function(t,e){return t.variants[0].price>e.variants[0].price?-1:t.variants[0].price<e.variants[0].price?1:0})}}createProductListString(t){let e=[];return t.map(t=>{let{body_html:r,created_at:s,id:n,options:o,product_type:i,published_at:a,tags:c,title:l,updated_at:u,vendor:d}=t,p=t.images[0].src,m=t.variants[0].price,h=(t.variants[0].title,`\n          <div class="product">\n          <div class="image-container">\n            <img src="${p}" alt="${l} from Eclectees Co"/>\n          </div>\n          <div class="product-details match-height">\n            <div class="title">\n              <p>${l}</p>\n            </div>\n            <div class="price">\n              <p>£${m}</p>\n            </div>\n          </div>\n          <div class="product-buttons">\n            <button class="button button-red add-to-cart" data-product-id="${n}">Add to cart</button>\n            <button class="button button-grey">Quick view</button>\n          </div>\n        </div>\n      `);e.push(h)}),e=e.join("")}render(){let t=this;if(0!==i.state.products.length){let e=i.state.products[0].products;this.filterProductsArray(e);let r=this.createProductListString(e);t.element.innerHTML=r}}},p=new class extends a{constructor(){super({store:i,element:document.querySelector(".filters")})}render(){this.element.innerHTML=`\n      <div class="filters">\n        <p>Sort by </p>\n        <div class="filter">\n          <select name="title-sort">\n            <option value="default-title-sort" ${"default-title-sort"==i.state.filters.title?"selected":""} disabled>Title</option>\n            <option value="a-z" ${"a-z"==i.state.filters.title?"selected":""}>A-Z</option>\n            <option value="z-a" ${"z-a"==i.state.filters.title?"selected":""}>Z-A</option>\n          </select>\n        </div>\n        <div class="filter">\n          <select name="price-sort" >\n            <option value="default-price-sort" ${"default-price-sort"==i.state.filters.price?"selected":""} disabled>Price</option>\n            <option value="low-high" ${"low-high"==i.state.filters.price?"selected":""}>Low - High</option>\n            <option value="high-low" ${"high-low"==i.state.filters.price?"selected":""}>High - Low</option>\n          </select>\n        </div>\n      </div>\n    `,this.element.querySelectorAll("select").forEach(t=>{t.addEventListener("change",t=>{t.target.name;let e=t.target.value;"title-sort"==t.target.name?i.dispatch("sortTitle",e):"price-sort"==t.target.name&&i.dispatch("sortPrice",e)})})}};c.render(),l.render(),u.render(),d.render(),p.render()}]);
//# sourceMappingURL=app.0543a237.js.map